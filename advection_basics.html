<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Advection solvers &mdash; pyro 4.1.0.post11+gbc93acc5 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/theme_overrides.css?v=2e394b92" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=830a3ad8"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="_static/copybutton.js?v=f281be69"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Burgers’ Equation" href="burgers_basics.html" />
    <link rel="prev" title="Mesh examples" href="mesh-examples.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            pyro
              <img src="_static/logo.gif" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                4.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">pyro basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction to pyro</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Setting up pyro</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes.html">Notes on the numerical methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html">Design ideas</a></li>
<li class="toctree-l1"><a class="reference internal" href="running.html">Running</a></li>
<li class="toctree-l1"><a class="reference internal" href="output.html">Working with output</a></li>
<li class="toctree-l1"><a class="reference internal" href="problems.html">Adding a problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="mesh_basics.html">Mesh overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="mesh-examples.html">Mesh examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="mesh-examples.html#Spherical-Polar-Grid">Spherical Polar Grid</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Solvers</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Advection solvers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#advection-solver"><code class="docutils literal notranslate"><span class="pre">advection</span></code> solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="#advection-fv4-solver"><code class="docutils literal notranslate"><span class="pre">advection_fv4</span></code> solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="#advection-nonuniform-solver"><code class="docutils literal notranslate"><span class="pre">advection_nonuniform</span></code> solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="#advection-rk-solver"><code class="docutils literal notranslate"><span class="pre">advection_rk</span></code> solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="#advection-weno-solver"><code class="docutils literal notranslate"><span class="pre">advection_weno</span></code> solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="#general-ideas">General ideas</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#smooth">smooth</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tophat">tophat</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#exercises">Exercises</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#explorations">Explorations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extensions">Extensions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="burgers_basics.html">Burgers’ Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="compressible_basics.html">Compressible hydrodynamics solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="compressible_compare.html">Compressible solver comparisons</a></li>
<li class="toctree-l1"><a class="reference internal" href="multigrid.html">Multigrid Solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="diffusion_basics.html">Diffusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="incompressible_basics.html">Incompressible hydrodynamics solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="incompressible_viscous_basics.html">Incompressible viscous hydrodynamics solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="lowmach_basics.html">Low Mach number hydrodynamics solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="swe_basics.html">Shallow water solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="particles_basics.html">Particles</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="analysis.html">Analysis routines</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="help.html">Contributing and getting help</a></li>
<li class="toctree-l1"><a class="reference internal" href="ack.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="ack.html#history">History</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Software Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyro</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Advection solvers</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/advection_basics.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="advection-solvers">
<h1>Advection solvers<a class="headerlink" href="#advection-solvers" title="Link to this heading"></a></h1>
<p>The linear advection equation:</p>
<div class="math notranslate nohighlight">
\[a_t + u a_x + v a_y = 0\]</div>
<p>provides a good basis for understanding the methods used for
compressible hydrodynamics. Chapter 4 of the notes summarizes the
numerical methods for advection that we implement in pyro.</p>
<p>pyro has several solvers for linear advection, which solve the equation
with different spatial and temporal integration schemes.</p>
<section id="advection-solver">
<h2><code class="docutils literal notranslate"><span class="pre">advection</span></code> solver<a class="headerlink" href="#advection-solver" title="Link to this heading"></a></h2>
<p><a class="reference internal" href="pyro.advection.html#module-pyro.advection" title="pyro.advection"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyro.advection</span></code></a> implements the directionally unsplit corner
transport upwind algorithm <span id="id1">[<a class="reference internal" href="zreferences.html#id2" title="P. Colella. Multidimensional upwind methods for hyperbolic conservation laws. Journal of Computational Physics, 87:171-200, March 1990. doi:10.1016/0021-9991(90)90233-Q.">Colella90</a>]</span> with piecewise linear reconstruction.
This is an overall second-order accurate method, with timesteps restricted
by</p>
<div class="math notranslate nohighlight">
\[\Delta t &lt; \min \left \{ \frac{\Delta x}{|u|}, \frac{\Delta y}{|v|} \right \}\]</div>
<p>The parameters for this solver are:</p>
<ul>
<li><p>section: [advection]</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>u</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1.0</span></code></p></td>
<td><p>advective velocity in x-direction</p></td>
</tr>
<tr class="row-odd"><td><p>v</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1.0</span></code></p></td>
<td><p>advective velocity in y-direction</p></td>
</tr>
<tr class="row-even"><td><p>limiter</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p></td>
<td><p>limiter (0 = none, 1 = 2nd order, 2 = 4th order)</p></td>
</tr>
</tbody>
</table>
</li>
<li><p>section: [driver]</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>cfl</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.8</span></code></p></td>
<td><p>advective CFL number</p></td>
</tr>
</tbody>
</table>
</li>
<li><p>section: [particles]</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>do_particles</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>particle_generator</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">grid</span></code></p></td>
<td></td>
</tr>
</tbody>
</table>
</li>
</ul>
</section>
<section id="advection-fv4-solver">
<h2><code class="docutils literal notranslate"><span class="pre">advection_fv4</span></code> solver<a class="headerlink" href="#advection-fv4-solver" title="Link to this heading"></a></h2>
<p><a class="reference internal" href="pyro.advection_fv4.html#module-pyro.advection_fv4" title="pyro.advection_fv4"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyro.advection_fv4</span></code></a> uses a fourth-order accurate finite-volume
method with RK4 time integration, following the ideas in
<span id="id2">[<a class="reference internal" href="zreferences.html#id3" title="P. McCorquodale and P. Colella. A high-order finite-volume method for conservation laws on locally refined grids. Communication in Applied Mathematics and Computational Science, 6(1):1–25, 2011.">McCorquodaleColella11</a>]</span>.  It can be thought of as a
method-of-lines integration, and as such has a slightly more restrictive
timestep:</p>
<div class="math notranslate nohighlight">
\[\Delta t \lesssim \left [ \frac{|u|}{\Delta x} + \frac{|v|}{\Delta y} \right ]^{-1}\]</div>
<p>The main complexity comes from needing to average the flux over the
faces of the zones to achieve 4th order accuracy spatially.</p>
<p>The parameters for this solver are:</p>
<ul>
<li><p>section: [advection]</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>u</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1.0</span></code></p></td>
<td><p>advective velocity in x-direction</p></td>
</tr>
<tr class="row-odd"><td><p>v</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1.0</span></code></p></td>
<td><p>advective velocity in y-direction</p></td>
</tr>
<tr class="row-even"><td><p>limiter</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td><p>limiter (0 = none, 1 = ppm)</p></td>
</tr>
<tr class="row-odd"><td><p>temporal_method</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">RK4</span></code></p></td>
<td><p>integration method (see mesh/integrators.py)</p></td>
</tr>
</tbody>
</table>
</li>
<li><p>section: [driver]</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>cfl</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.8</span></code></p></td>
<td><p>advective CFL number</p></td>
</tr>
</tbody>
</table>
</li>
</ul>
</section>
<section id="advection-nonuniform-solver">
<h2><code class="docutils literal notranslate"><span class="pre">advection_nonuniform</span></code> solver<a class="headerlink" href="#advection-nonuniform-solver" title="Link to this heading"></a></h2>
<p><a class="reference internal" href="pyro.advection_nonuniform.html#module-pyro.advection_nonuniform" title="pyro.advection_nonuniform"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyro.advection_nonuniform</span></code></a> models advection with a non-uniform
velocity field.  This is used to implement the slotted disk problem
from <span id="id3">[<a class="reference internal" href="zreferences.html#id4" title="Steven T Zalesak. Fully multidimensional flux-corrected transport algorithms for fluids. Journal of Computational Physics, 31(3):335 - 362, 1979. doi:https://doi.org/10.1016/0021-9991(79)90051-2.">Zal79</a>]</span>.  The basic method is similar to the
algorithm used by the main <code class="docutils literal notranslate"><span class="pre">advection</span></code> solver.</p>
<p>The parameters for this solver are:</p>
<ul>
<li><p>section: [advection]</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>u</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1.0</span></code></p></td>
<td><p>advective velocity in x-direction</p></td>
</tr>
<tr class="row-odd"><td><p>v</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1.0</span></code></p></td>
<td><p>advective velocity in y-direction</p></td>
</tr>
<tr class="row-even"><td><p>limiter</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p></td>
<td><p>limiter (0 = none, 1 = 2nd order, 2 = 4th order)</p></td>
</tr>
</tbody>
</table>
</li>
<li><p>section: [driver]</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>cfl</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.8</span></code></p></td>
<td><p>advective CFL number</p></td>
</tr>
</tbody>
</table>
</li>
<li><p>section: [particles]</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>do_particles</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>particle_generator</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">grid</span></code></p></td>
<td></td>
</tr>
</tbody>
</table>
</li>
</ul>
</section>
<section id="advection-rk-solver">
<h2><code class="docutils literal notranslate"><span class="pre">advection_rk</span></code> solver<a class="headerlink" href="#advection-rk-solver" title="Link to this heading"></a></h2>
<p><a class="reference internal" href="pyro.advection_rk.html#module-pyro.advection_rk" title="pyro.advection_rk"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyro.advection_rk</span></code></a> uses a method of lines time-integration
approach with piecewise linear spatial reconstruction for linear
advection.  This is overall second-order accurate, so it represents a
simpler algorithm than the <code class="docutils literal notranslate"><span class="pre">advection_fv4</span></code> method (in particular, we
can treat cell-centers and cell-averages as the same, to second
order).</p>
<p>The parameter for this solver are:</p>
<ul>
<li><p>section: [advection]</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>u</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1.0</span></code></p></td>
<td><p>advective velocity in x-direction</p></td>
</tr>
<tr class="row-odd"><td><p>v</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1.0</span></code></p></td>
<td><p>advective velocity in y-direction</p></td>
</tr>
<tr class="row-even"><td><p>limiter</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p></td>
<td><p>limiter (0 = none, 1 = 2nd order, 2 = 4th order)</p></td>
</tr>
<tr class="row-odd"><td><p>temporal_method</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">RK4</span></code></p></td>
<td><p>integration method (see mesh/integrators.py)</p></td>
</tr>
</tbody>
</table>
</li>
<li><p>section: [driver]</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>cfl</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.8</span></code></p></td>
<td><p>advective CFL number</p></td>
</tr>
</tbody>
</table>
</li>
</ul>
</section>
<section id="advection-weno-solver">
<h2><code class="docutils literal notranslate"><span class="pre">advection_weno</span></code> solver<a class="headerlink" href="#advection-weno-solver" title="Link to this heading"></a></h2>
<p><a class="reference internal" href="pyro.advection_weno.html#module-pyro.advection_weno" title="pyro.advection_weno"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyro.advection_weno</span></code></a> uses a WENO reconstruction and method of
lines time-integration</p>
<p>The main parameters that affect this solver are:</p>
<ul>
<li><p>section: [advection]</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>u</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1.0</span></code></p></td>
<td><p>advective velocity in x-direction</p></td>
</tr>
<tr class="row-odd"><td><p>v</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1.0</span></code></p></td>
<td><p>advective velocity in y-direction</p></td>
</tr>
<tr class="row-even"><td><p>limiter</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p></td>
<td><p>Unused here, but needed to inherit from advection
base class</p></td>
</tr>
<tr class="row-odd"><td><p>weno_order</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">3</span></code></p></td>
<td><p>k in WENO scheme</p></td>
</tr>
<tr class="row-even"><td><p>temporal_method</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">RK4</span></code></p></td>
<td><p>integration method (see mesh/integrators.py)</p></td>
</tr>
</tbody>
</table>
</li>
<li><p>section: [driver]</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>cfl</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.5</span></code></p></td>
<td><p>advective CFL number</p></td>
</tr>
</tbody>
</table>
</li>
</ul>
</section>
<section id="general-ideas">
<h2>General ideas<a class="headerlink" href="#general-ideas" title="Link to this heading"></a></h2>
<p>The main use for the advection solver is to understand how Godunov
techniques work for hyperbolic problems. These same ideas will be used
in the compressible and incompressible solvers. This video shows
graphically how the basic advection algorithm works, consisting of
reconstruction, evolution, and averaging steps:</p>
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; height: auto;">
    <iframe src="https://www.youtube.com/embed/Z_yFd5HqOqc?rel=0" frameborder="0" allowfullscreen style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"></iframe>
</div><br></section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h2>
<section id="smooth">
<h3>smooth<a class="headerlink" href="#smooth" title="Link to this heading"></a></h3>
<p>The smooth problem initializes a Gaussian profile and advects it with
<span class="math notranslate nohighlight">\(u = v = 1\)</span> through periodic boundaries for a period. The result is that
the final state should be identical to the initial state—any
disagreement is our numerical error. This is run as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><style type="text/css">
span.prompt1:before {
  content: "$ ";
}
</style><span class="prompt1">pyro_sim.py<span class="w"> </span>advection<span class="w"> </span>smooth<span class="w"> </span>inputs.smooth</span>
</pre></div></div><div style="position: relative; padding-bottom: 75%; height: 0; overflow: hidden; max-width: 100%; height: auto;">
    <iframe src="https://www.youtube.com/embed/712Y0ocuz2M?rel=0" frameborder="0" allowfullscreen style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"></iframe>
</div><br><p>By varying the resolution and comparing to the analytic solution, we
can measure the convergence rate of the method. The <code class="docutils literal notranslate"><span class="pre">smooth_error.py</span></code>
script in <code class="docutils literal notranslate"><span class="pre">analysis/</span></code> will compare an output file to the analytic
solution for this problem.</p>
<img alt="_images/smooth_converge.png" class="align-center" src="_images/smooth_converge.png" />
<p>The points above are the L2-norm of the absolute error for the smooth
advection problem after 1 period with <code class="docutils literal notranslate"><span class="pre">CFL=0.8</span></code>, for both the
<code class="docutils literal notranslate"><span class="pre">advection</span></code> and <code class="docutils literal notranslate"><span class="pre">advection_fv4</span></code> solvers.  The dashed and dotted
lines show ideal scaling.  We see that we achieve nearly 2nd order
convergence for the <code class="docutils literal notranslate"><span class="pre">advection</span></code> solver and 4th order convergence
with the <code class="docutils literal notranslate"><span class="pre">advection_fv4</span></code> solver.  Departures from perfect scaling
are likely due to the use of limiters.</p>
</section>
<section id="tophat">
<h3>tophat<a class="headerlink" href="#tophat" title="Link to this heading"></a></h3>
<p>The tophat problem initializes a circle in the center of the domain
with value 1, and 0 outside. This has very steep jumps, and the
limiters will kick in strongly here.</p>
</section>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading"></a></h2>
<p>The best way to learn these methods is to play with them yourself. The
exercises below are suggestions for explorations and features to add
to the advection solver.</p>
<section id="explorations">
<h3>Explorations<a class="headerlink" href="#explorations" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Test the convergence of the solver for a variety of initial
conditions (tophat hat will differ from the smooth case because of
limiting). Test with limiting on and off, and also test with the
slopes set to 0 (this will reduce it down to a piecewise constant
reconstruction method).</p></li>
<li><p>Run without any limiting and look for oscillations and under and
overshoots (does the advected quantity go negative in the tophat
problem?)</p></li>
</ul>
</section>
<section id="extensions">
<h3>Extensions<a class="headerlink" href="#extensions" title="Link to this heading"></a></h3>
<ul>
<li><p>Implement a dimensionally split version of the advection
algorithm. How does the solution compare between the unsplit and
split versions? Look at the amount of overshoot and undershoot, for
example.</p></li>
<li><p>Research the inviscid Burger’s equation—this looks like the
advection equation, but now the quantity being advected is the
velocity itself, so this is a non-linear equation. It is very
straightforward to modify this solver to solve Burger’s equation
(the main things that need to change are the Riemann solver and the
fluxes, and the computation of the timestep).</p>
<p>The neat thing about Burger’s equation is that it admits shocks and
rarefactions, so some very interesting flow problems can be setup.</p>
</li>
</ul>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mesh-examples.html" class="btn btn-neutral float-left" title="Mesh examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="burgers_basics.html" class="btn btn-neutral float-right" title="Burgers’ Equation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, pyro development team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>