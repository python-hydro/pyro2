
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Mesh examples &#8212; pyro 4.4.0.post31+g229f64ada documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="_static/myfile.css?v=359afcf4" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=b7b791d5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["\\(", "\\)"]], "processEscapes": true, "displayMath": [["\\[", "\\]"]], "macros": {"rhozero": "{\\rho_0}", "pizero": "{\\pi_0}", "pizeroone": "{\\pi_0^{(1)}}", "pizerotwo": "{\\pi_0^{(2)}}", "gammabar": "{\\overline{\\Gamma}_1}", "ptl": "{{\\partial}}", "eb": "{{\\bf e}}", "fb": "{{\\bf f}}", "ib": "{{\\bf i}}", "Ub": "{{\\bf U}}", "Vb": "{{\\bf V}}", "xb": "{{\\bf x}}", "ut": "{\\tilde{u}}", "vt": "{\\tilde{v}}", "wt": "{\\tilde{w}}", "Ubt": "{\\widetilde{\\Ub}}", "edge": "{\\rm EDGE}", "mac": "{\\rm MAC}", "trans": "{\\rm TRANS}", "nablab": "{\\mathbf{\\nabla}}", "cdotb": "{\\mathbf{\\cdot}}", "half": "{\\frac{1}{2}}", "myhalf": "{\\frac{1}{2}}", "nph": "{{n + \\myhalf}}", "nmh": "{{n - \\myhalf}}", "Hext": "{{H_{\\rm ext}}}", "Hnuc": "{{H_{\\rm nuc}}}", "kth": "{k_{\\rm th}}", "pred": "{{\\rm pred}}", "Sbar": "{\\overline{S}}", "inp": "{\\mathrm{in}}", "initp": "{\\mathrm{init}}", "outp": "{\\mathrm{out}}", "uadv": "{\\widetilde{\\mathbf{U}}^{\\mathrm{ADV}}}", "uadvone": "{\\widetilde{\\mathbf{U}}^{\\mathrm{ADV},\\star}}", "uadvonedag": "{\\Ubt^{\\mathrm{ADV},\\dagger,\\star}}", "uadvtwo": "{\\widetilde{\\mathbf{U}}^{\\mathrm{ADV}}}", "uadvtwodag": "{\\Ubt^{\\mathrm{ADV},\\dagger}}", "uadvsdcstar": "{\\mathbf{U}^{\\mathrm{ADV},\\star}}", "uadvsdcpred": "{\\mathbf{U}^{\\mathrm{ADV},\\mathrm{pred}}}", "uadvsdc": "{\\mathbf{U}^{\\mathrm{ADV}}}", "dt": "{\\Delta t}", "dr": "{\\Delta r}", "etarho": "{\\eta_{\\rho}}", "etarhoec": "{\\etarho^{\\rm ec}}", "etarhocc": "{\\etarho^{\\rm cc}}", "etarhoflux": "{\\etarho^{\\rm flux}}", "divetarho": "{\\nabla\\cdot(\\etarho\\eb_r)}", "ow": "{\\overline{w}_0}", "dw": "{\\delta w_0}", "thalf": "{\\sfrac{3}{2}}", "rhop": "{{\\rho^{\\prime}}}", "omegadot": "{\\dot{\\omega}}", "er": "{\\mathbf{e}_r}", "ex": "{\\mathbf{e}_x}", "ey": "{\\mathbf{e}_y}", "ez": "{\\mathbf{e}_z}", "Omegab": "{{\\bf \\Omega}}", "rb": "{{\\bf r}}", "isotm": ["{{}^{#2}\\mathrm{#1}}", 2], "edot": "{{{\\dot{e}_\\mathrm{nuc}}}}", "enuc": "{{{{e}_\\mathrm{nuc}}}}", "edotnu": "{{{\\dot{e}_\\nu}}}", "rt": "{\\tilde{r}_0}", "rhob": "{\\ensuremath{\\rho_\\mathrm{base}}}", "Tb": "{\\ensuremath{T_\\mathrm{base}}}", "gcc": "{\\mathrm{g~cm^{-3} }}", "pb": "{p_\\mathrm{base}}", "qburn": "{q_\\mathrm{burn}}", "Uc": "{{\\boldsymbol{\\mathcal{U}}}}", "Fb": "{\\mathbf{F}}", "Sc": "{\\mathbf{S}}", "Shydro": "{{{\\bf S}^{\\mathrm{hydro}}}}", "Rb": "{{\\bf R}}", "Rbs": ["{{\\bf R} \\left ( #1 \\right )}", 1], "Rq": "{{\\bf R}}", "Adv": ["{{\\left [\\boldsymbol{\\mathcal{A}} \\left(#1\\right)\\right]}}", 1], "Advs": ["{{\\boldsymbol{\\mathcal{A}} \\left(#1\\right)}}", 1], "Sdot": "{\\dot{S}}"}}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'mesh-examples';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Spherical Polar Grid" href="spherical-mesh.html" />
    <link rel="prev" title="Mesh overview" href="mesh_basics.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="4.4" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.gif" class="logo__image only-light" alt=""/>
    <img src="_static/logo.gif" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">pyro 4.4</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">pyro basics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction to pyro</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Setting up pyro</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes.html">Notes on the numerical methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html">Design ideas</a></li>
<li class="toctree-l1"><a class="reference internal" href="running.html">Running</a></li>
<li class="toctree-l1"><a class="reference internal" href="output.html">Working with output</a></li>
<li class="toctree-l1"><a class="reference internal" href="problems.html">Adding a problem</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Mesh</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="mesh_basics.html">Mesh overview</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Mesh examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="spherical-mesh.html">Spherical Polar Grid</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Multigrid</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="multigrid.html">Multigrid Solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="multigrid_basics.html">Simple Multigrid Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="multigrid-constant-coefficients.html">Constant-Coefficient Poisson Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="multigrid-variable-coeff.html">Variable Coefficient Poisson</a></li>
<li class="toctree-l1"><a class="reference internal" href="multigrid-general-linear.html">General Linear Elliptic Equation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Hydro Solvers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="advection_basics.html">Advection</a></li>
<li class="toctree-l1"><a class="reference internal" href="burgers_basics.html">Burgers’ Equation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="compressible_basics.html">Compressible hydrodynamics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="compressible_problems.html">Compressible example problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="compressible_sources.html">Compressible source terms</a></li>
<li class="toctree-l2"><a class="reference internal" href="compressible_exercises.html">Compressible exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="diffusion_basics.html">Diffusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="incompressible_basics.html">Incompressible hydrodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="lowmach_basics.html">Low Mach number hydrodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="swe_basics.html">Shallow water hydrodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="particles_basics.html">Particles</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="compressible-rt-compare.html">Comparing the Compressible Solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="adding_a_problem_jupyter.html">Defining our own problem in Jupyter</a></li>
<li class="toctree-l1"><a class="reference internal" href="rt_average.html">Horizontal Averages of Rayleigh-Taylor</a></li>
<li class="toctree-l1"><a class="reference internal" href="advection-error.html">Error Measurement of the <code class="docutils literal notranslate"><span class="pre">advection_fv4</span></code> Solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="compressible-convergence.html">Convergence of the compressible solvers</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Utilities</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="analysis.html">Analysis routines</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="help.html">Contributing and getting help</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="ack.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="citing.html">Citing pyro</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Software Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="modules.html">API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="pyro.html">pyro package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.advection.html">pyro.advection package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.advection.problems.html">pyro.advection.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.advection_fv4.html">pyro.advection_fv4 package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.advection_fv4.problems.html">pyro.advection_fv4.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.advection_nonuniform.html">pyro.advection_nonuniform package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.advection_nonuniform.problems.html">pyro.advection_nonuniform.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.advection_rk.html">pyro.advection_rk package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.advection_rk.problems.html">pyro.advection_rk.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.advection_weno.html">pyro.advection_weno package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.advection_weno.problems.html">pyro.advection_weno.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.burgers.html">pyro.burgers package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.burgers.problems.html">pyro.burgers.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.burgers_viscous.html">pyro.burgers_viscous package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.burgers_viscous.problems.html">pyro.burgers_viscous.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.compressible.html">pyro.compressible package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.compressible.problems.html">pyro.compressible.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.compressible_fv4.html">pyro.compressible_fv4 package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.compressible_fv4.problems.html">pyro.compressible_fv4.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.compressible_react.html">pyro.compressible_react package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.compressible_react.problems.html">pyro.compressible_react.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.compressible_rk.html">pyro.compressible_rk package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.compressible_rk.problems.html">pyro.compressible_rk.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.compressible_sdc.html">pyro.compressible_sdc package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.compressible_sdc.problems.html">pyro.compressible_sdc.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.diffusion.html">pyro.diffusion package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.diffusion.problems.html">pyro.diffusion.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.incompressible.html">pyro.incompressible package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.incompressible.problems.html">pyro.incompressible.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.incompressible_viscous.html">pyro.incompressible_viscous package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.incompressible_viscous.problems.html">pyro.incompressible_viscous.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.lm_atm.html">pyro.lm_atm package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.lm_atm.problems.html">pyro.lm_atm.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="pyro.mesh.html">pyro.mesh package</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.multigrid.html">pyro.multigrid package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.multigrid.examples.html">pyro.multigrid.examples package</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="pyro.particles.html">pyro.particles package</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.swe.html">pyro.swe package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.swe.problems.html">pyro.swe.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="pyro.util.html">pyro.util package</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/python-hydro/pyro2" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/python-hydro/pyro2/blob/main/docs/source/mesh-examples.ipynb?plain=1" target="_blank"
   class="btn btn-sm btn-source-file-button dropdown-item"
   title="Show source"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">Show source</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/python-hydro/pyro2/edit/main/docs/source/mesh-examples.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/python-hydro/pyro2/issues/new?title=Issue%20on%20page%20%2Fmesh-examples.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/mesh-examples.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Mesh examples</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Setup-a-Grid-with-Variables">Setup a Grid with Variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Working-with-the-data">Working with the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ArrayIndexer"><code class="docutils literal notranslate"><span class="pre">ArrayIndexer</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Differencing">Differencing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Coarsening-and-prolonging">Coarsening and prolonging</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="Mesh-examples">
<h1>Mesh examples<a class="headerlink" href="#Mesh-examples" title="Link to this heading">#</a></h1>
<p>this notebook illustrates the basic ways of interacting with the pyro2 mesh module. We create some data that lives on a grid and show how to fill the ghost cells. The pretty_print() function shows us that they work as expected.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pyro.mesh.boundary</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">bnd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyro.mesh.patch</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">patch</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># for unit testing, we want to ensure the same random numbers</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Setup-a-Grid-with-Variables">
<h2>Setup a Grid with Variables<a class="headerlink" href="#Setup-a-Grid-with-Variables" title="Link to this heading">#</a></h2>
<p>There are a few core classes that we deal with when creating a grid with associated variables:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Grid2d</span></code> : this holds the size of the grid (in zones) and the physical coordinate information, including coordinates of cell edges and centers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BC</span></code> : this is a container class that simply holds the type of boundary condition on each domain edge.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ArrayIndexer</span></code> : this is an array of data along with methods that know how to access it with different offsets into the data that usually arise in stencils (like {i+1, j})</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CellCenterData2d</span></code> : this holds the data that lives on a grid. Each variable that is part of this class has its own boundary condition type.</p></li>
</ul>
<p>We start by creating a <code class="docutils literal notranslate"><span class="pre">Grid2d</span></code> object with 4 x 6 cells and 2 ghost cells</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">patch</span><span class="o">.</span><span class="n">Grid2d</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">ng</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2-d grid: nx = 4, ny = 6, ng = 2
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on Grid2d in module pyro.mesh.patch object:

class Grid2d(builtins.object)
 |  Grid2d(nx, ny, *, ng=1, xmin=0.0, xmax=1.0, ymin=0.0, ymax=1.0)
 |
 |  the 2-d grid class.  The grid object will contain the coordinate
 |  information (at various centerings).
 |
 |  A basic (1-d) representation of the layout is::
 |
 |     |     |      |     X     |     |      |     |     X     |      |     |
 |     +--*--+- // -+--*--X--*--+--*--+- // -+--*--+--*--X--*--+- // -+--*--+
 |        0          ng-1    ng   ng+1         ... ng+nx-1 ng+nx      2ng+nx-1
 |
 |                          ilo                      ihi
 |
 |     |&lt;- ng guardcells-&gt;|&lt;---- nx interior zones -----&gt;|&lt;- ng guardcells-&gt;|
 |
 |  The &#39;*&#39; marks the data locations.
 |
 |  Methods defined here:
 |
 |  __eq__(self, other)
 |      are two grids equivalent?
 |
 |  __init__(self, nx, ny, *, ng=1, xmin=0.0, xmax=1.0, ymin=0.0, ymax=1.0)
 |      Create a Grid2d object.
 |
 |      The only data that we require is the number of points that
 |      make up the mesh in each direction.  Optionally we take the
 |      extrema of the domain (default is [0,1]x[0,1]) and number of
 |      ghost cells (default is 1).
 |
 |      Note that the Grid2d object only defines the discretization,
 |      it does not know about the boundary conditions, as these can
 |      vary depending on the variable.
 |
 |      Parameters
 |      ----------
 |      nx : int
 |          Number of zones in the x-direction
 |      ny : int
 |          Number of zones in the y-direction
 |      ng : int, optional
 |          Number of ghost cells
 |      xmin : float, optional
 |          Physical coordinate at the lower x boundary
 |      xmax : float, optional
 |          Physical coordinate at the upper x boundary
 |      ymin : float, optional
 |          Physical coordinate at the lower y boundary
 |      ymax : float, optional
 |          Physical coordinate at the upper y boundary
 |
 |  __str__(self)
 |      print out some basic information about the grid object
 |
 |  coarse_like(self, N)
 |      return a new grid object coarsened by a factor n, but with
 |      all the other properties the same
 |
 |  fine_like(self, N)
 |      return a new grid object finer by a factor n, but with
 |      all the other properties the same
 |
 |  scratch_array(self, *, nvar=1)
 |      return a standard numpy array dimensioned to have the size
 |      and number of ghostcells as the parent grid
 |
 |  ----------------------------------------------------------------------
 |  Data descriptors defined here:
 |
 |  __dict__
 |      dictionary for instance variables
 |
 |  __weakref__
 |      list of weak references to the object
 |
 |  ----------------------------------------------------------------------
 |  Data and other attributes defined here:
 |
 |  __hash__ = None

</pre></div></div>
</div>
<p>Then create a dataset that lives on this grid and add a variable name. For each variable that lives on the grid, we need to define the boundary conditions – this is done through the BC object.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bc</span> <span class="o">=</span> <span class="n">bnd</span><span class="o">.</span><span class="n">BC</span><span class="p">(</span><span class="n">xlb</span><span class="o">=</span><span class="s2">&quot;periodic&quot;</span><span class="p">,</span> <span class="n">xrb</span><span class="o">=</span><span class="s2">&quot;periodic&quot;</span><span class="p">,</span> <span class="n">ylb</span><span class="o">=</span><span class="s2">&quot;reflect&quot;</span><span class="p">,</span> <span class="n">yrb</span><span class="o">=</span><span class="s2">&quot;outflow&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
BCs: -x: periodic  +x: periodic  -y: reflect-even  +y: outflow
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">patch</span><span class="o">.</span><span class="n">CellCenterData2d</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">register_var</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">bc</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
cc data: nx = 4, ny = 6, ng = 2
         nvars = 1
         variables:
               a: min:    0.0000000000    max:    0.0000000000
                  BCs: -x: periodic     +x: periodic     -y: reflect-even +y: outflow

</pre></div></div>
</div>
</section>
<section id="Working-with-the-data">
<h2>Working with the data<a class="headerlink" href="#Working-with-the-data" title="Link to this heading">#</a></h2>
<p>Now we fill the grid with random data. <code class="docutils literal notranslate"><span class="pre">get_var()</span></code> returns an <code class="docutils literal notranslate"><span class="pre">ArrayIndexer</span></code> object that has methods for accessing views into the data. Here we use <code class="docutils literal notranslate"><span class="pre">a.v()</span></code> to get the “valid” region, i.e. excluding ghost cells.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">get_var</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">v</span><span class="p">()[:,:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">ny</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>when we pretty_print() the variable, we see the ghost cells colored red. Note that we just filled the interior above.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>
<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>
<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>   0.12157    0.2092   0.17194   0.33611<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>
<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span> 0.0047189   0.89132   0.81168   0.81765<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>
<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>   0.84478   0.57509   0.97862   0.94003<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>
<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>   0.42452   0.13671    0.2197    0.4317<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>
<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>   0.27837   0.82585   0.10838   0.27407<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>
<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>    0.5434   0.67075   0.18533   0.81622<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>
<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>
<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>

         ^ y
         |
         +---&gt; x

</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pretty_print()</span></code> can also take an argument, specifying the format string to be used for the output.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%7.3g</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span>
<span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span>
<span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span>  0.122  0.209  0.172  0.336<span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span>
<span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span>0.00472  0.891  0.812  0.818<span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span>
<span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span>  0.845  0.575  0.979   0.94<span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span>
<span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span>  0.425  0.137   0.22  0.432<span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span>
<span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span>  0.278  0.826  0.108  0.274<span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span>
<span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span>  0.543  0.671  0.185  0.816<span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span>
<span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span>
<span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span><span class="ansi-red-fg">      0</span>

         ^ y
         |
         +---&gt; x

</pre></div></div>
</div>
<p>now fill the ghost cells – notice that the left and right are periodic, the upper is outflow, and the lower is reflect, as specified when we registered the data above.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">fill_BC</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">   0.17194</span><span class="ansi-red-fg">   0.33611</span><span class="ansi-red-fg">   0.12157</span><span class="ansi-red-fg">    0.2092</span><span class="ansi-red-fg">   0.17194</span><span class="ansi-red-fg">   0.33611</span><span class="ansi-red-fg">   0.12157</span><span class="ansi-red-fg">    0.2092</span>
<span class="ansi-red-fg">   0.17194</span><span class="ansi-red-fg">   0.33611</span><span class="ansi-red-fg">   0.12157</span><span class="ansi-red-fg">    0.2092</span><span class="ansi-red-fg">   0.17194</span><span class="ansi-red-fg">   0.33611</span><span class="ansi-red-fg">   0.12157</span><span class="ansi-red-fg">    0.2092</span>
<span class="ansi-red-fg">   0.17194</span><span class="ansi-red-fg">   0.33611</span>   0.12157    0.2092   0.17194   0.33611<span class="ansi-red-fg">   0.12157</span><span class="ansi-red-fg">    0.2092</span>
<span class="ansi-red-fg">   0.81168</span><span class="ansi-red-fg">   0.81765</span> 0.0047189   0.89132   0.81168   0.81765<span class="ansi-red-fg"> 0.0047189</span><span class="ansi-red-fg">   0.89132</span>
<span class="ansi-red-fg">   0.97862</span><span class="ansi-red-fg">   0.94003</span>   0.84478   0.57509   0.97862   0.94003<span class="ansi-red-fg">   0.84478</span><span class="ansi-red-fg">   0.57509</span>
<span class="ansi-red-fg">    0.2197</span><span class="ansi-red-fg">    0.4317</span>   0.42452   0.13671    0.2197    0.4317<span class="ansi-red-fg">   0.42452</span><span class="ansi-red-fg">   0.13671</span>
<span class="ansi-red-fg">   0.10838</span><span class="ansi-red-fg">   0.27407</span>   0.27837   0.82585   0.10838   0.27407<span class="ansi-red-fg">   0.27837</span><span class="ansi-red-fg">   0.82585</span>
<span class="ansi-red-fg">   0.18533</span><span class="ansi-red-fg">   0.81622</span>    0.5434   0.67075   0.18533   0.81622<span class="ansi-red-fg">    0.5434</span><span class="ansi-red-fg">   0.67075</span>
<span class="ansi-red-fg">   0.18533</span><span class="ansi-red-fg">   0.81622</span><span class="ansi-red-fg">    0.5434</span><span class="ansi-red-fg">   0.67075</span><span class="ansi-red-fg">   0.18533</span><span class="ansi-red-fg">   0.81622</span><span class="ansi-red-fg">    0.5434</span><span class="ansi-red-fg">   0.67075</span>
<span class="ansi-red-fg">   0.10838</span><span class="ansi-red-fg">   0.27407</span><span class="ansi-red-fg">   0.27837</span><span class="ansi-red-fg">   0.82585</span><span class="ansi-red-fg">   0.10838</span><span class="ansi-red-fg">   0.27407</span><span class="ansi-red-fg">   0.27837</span><span class="ansi-red-fg">   0.82585</span>

         ^ y
         |
         +---&gt; x

</pre></div></div>
</div>
<p>We can find the L2 norm of the data easily</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
np.float64(0.5749769043407793)
</pre></div></div>
</div>
<p>and the min and max</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">a</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.004718856190972565 0.9786237847073697
</pre></div></div>
</div>
</section>
<section id="ArrayIndexer">
<h2><code class="docutils literal notranslate"><span class="pre">ArrayIndexer</span></code><a class="headerlink" href="#ArrayIndexer" title="Link to this heading">#</a></h2>
<p>We we access the data, an <code class="docutils literal notranslate"><span class="pre">ArrayIndexer</span></code> object is returned. The <code class="docutils literal notranslate"><span class="pre">ArrayIndexer</span></code> sub-classes the NumPy <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>, so it can do all of the methods that a NumPy array can, but in addition, we can use the <code class="docutils literal notranslate"><span class="pre">ip()</span></code>, <code class="docutils literal notranslate"><span class="pre">jp()</span></code>, or <code class="docutils literal notranslate"><span class="pre">ip_jp()</span></code> methods to the <code class="docutils literal notranslate"><span class="pre">ArrayIndexer</span></code> object shift our view in the x, y, or x &amp; y directions.</p>
<p>To make this clearer, we’ll change our data set to be nicely ordered numbers. We index the <code class="docutils literal notranslate"><span class="pre">ArrayIndex</span></code> the same way we would a NumPy array. The index space includes ghost cells, so the <code class="docutils literal notranslate"><span class="pre">ilo</span></code> and <code class="docutils literal notranslate"><span class="pre">ihi</span></code> attributes from the grid object are useful to index just the valid region. The <code class="docutils literal notranslate"><span class="pre">.v()</span></code> method is a shortcut that also gives a view into just the valid data.</p>
<p>Note: when we use one of the <code class="docutils literal notranslate"><span class="pre">ip()</span></code>, <code class="docutils literal notranslate"><span class="pre">jp()</span></code>, <code class="docutils literal notranslate"><span class="pre">ip_jp()</span></code>, or <code class="docutils literal notranslate"><span class="pre">v()</span></code> methods, the result is a regular NumPy <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>, not an <code class="docutils literal notranslate"><span class="pre">ArrayIndexer</span></code> object. This is because it only spans part of the domain (e.g., no ghost cells), and therefore cannot be associated with the <code class="docutils literal notranslate"><span class="pre">Grid2d</span></code> object that the <code class="docutils literal notranslate"><span class="pre">ArrayIndexer</span></code> is built from.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
pyro.mesh.array_indexer.ArrayIndexer
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">v</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
numpy.ndarray
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">[:,:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">qx</span><span class="o">*</span><span class="n">g</span><span class="o">.</span><span class="n">qy</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">qx</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">qy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">         9</span><span class="ansi-red-fg">        19</span><span class="ansi-red-fg">        29</span><span class="ansi-red-fg">        39</span><span class="ansi-red-fg">        49</span><span class="ansi-red-fg">        59</span><span class="ansi-red-fg">        69</span><span class="ansi-red-fg">        79</span>
<span class="ansi-red-fg">         8</span><span class="ansi-red-fg">        18</span><span class="ansi-red-fg">        28</span><span class="ansi-red-fg">        38</span><span class="ansi-red-fg">        48</span><span class="ansi-red-fg">        58</span><span class="ansi-red-fg">        68</span><span class="ansi-red-fg">        78</span>
<span class="ansi-red-fg">         7</span><span class="ansi-red-fg">        17</span>        27        37        47        57<span class="ansi-red-fg">        67</span><span class="ansi-red-fg">        77</span>
<span class="ansi-red-fg">         6</span><span class="ansi-red-fg">        16</span>        26        36        46        56<span class="ansi-red-fg">        66</span><span class="ansi-red-fg">        76</span>
<span class="ansi-red-fg">         5</span><span class="ansi-red-fg">        15</span>        25        35        45        55<span class="ansi-red-fg">        65</span><span class="ansi-red-fg">        75</span>
<span class="ansi-red-fg">         4</span><span class="ansi-red-fg">        14</span>        24        34        44        54<span class="ansi-red-fg">        64</span><span class="ansi-red-fg">        74</span>
<span class="ansi-red-fg">         3</span><span class="ansi-red-fg">        13</span>        23        33        43        53<span class="ansi-red-fg">        63</span><span class="ansi-red-fg">        73</span>
<span class="ansi-red-fg">         2</span><span class="ansi-red-fg">        12</span>        22        32        42        52<span class="ansi-red-fg">        62</span><span class="ansi-red-fg">        72</span>
<span class="ansi-red-fg">         1</span><span class="ansi-red-fg">        11</span><span class="ansi-red-fg">        21</span><span class="ansi-red-fg">        31</span><span class="ansi-red-fg">        41</span><span class="ansi-red-fg">        51</span><span class="ansi-red-fg">        61</span><span class="ansi-red-fg">        71</span>
<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">        10</span><span class="ansi-red-fg">        20</span><span class="ansi-red-fg">        30</span><span class="ansi-red-fg">        40</span><span class="ansi-red-fg">        50</span><span class="ansi-red-fg">        60</span><span class="ansi-red-fg">        70</span>

         ^ y
         |
         +---&gt; x

</pre></div></div>
</div>
<p>We index our arrays as {i,j}, so x (indexed by i) is the row and y (indexed by j) is the column in the NumPy array. Note that python arrays are stored in row-major order, which means that all of the entries in the same row are adjacent in memory. This means that when we simply print out the <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>, we see constant-x horizontally, which is the transpose of what we are used to.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">v</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[22., 23., 24., 25., 26., 27.],
       [32., 33., 34., 35., 36., 37.],
       [42., 43., 44., 45., 46., 47.],
       [52., 53., 54., 55., 56., 57.]])
</pre></div></div>
</div>
<p>We can offset our view into the array by one in x – this would be like {i+1, j} when we loop over data. The <code class="docutils literal notranslate"><span class="pre">ip()</span></code> method is used here, and takes an argument which is the (positive) shift in the x (i) direction. So here’s a shift by 1</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">ip</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">buf</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.],
       [11., 12., 13., 14., 15., 16., 17., 18.],
       [21., 22., 23., 24., 25., 26., 27., 28.],
       [31., 32., 33., 34., 35., 36., 37., 38.],
       [41., 42., 43., 44., 45., 46., 47., 48.],
       [51., 52., 53., 54., 55., 56., 57., 58.]])
</pre></div></div>
</div>
<p>A shifted view is necessarily smaller than the original array, and relies on ghost cells to bring new data into view. Because of this, the underlying data is no longer the same size as the original data, so we return it as an <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> (which is actually just a view into the data in the <code class="docutils literal notranslate"><span class="pre">ArrayIndexer</span></code> object, so no copy is made.</p>
<p>To see that it is simply a view, lets shift and edit the data</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">ip</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">a</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">         9</span><span class="ansi-red-fg">        19</span><span class="ansi-red-fg">        29</span><span class="ansi-red-fg">        39</span><span class="ansi-red-fg">        49</span><span class="ansi-red-fg">        59</span><span class="ansi-red-fg">        69</span><span class="ansi-red-fg">        79</span>
<span class="ansi-red-fg">         8</span><span class="ansi-red-fg">        18</span><span class="ansi-red-fg">        28</span><span class="ansi-red-fg">        38</span><span class="ansi-red-fg">        48</span><span class="ansi-red-fg">        58</span><span class="ansi-red-fg">        68</span><span class="ansi-red-fg">        78</span>
<span class="ansi-red-fg">         7</span><span class="ansi-red-fg">        17</span>        27        37        47        57<span class="ansi-red-fg">        67</span><span class="ansi-red-fg">        77</span>
<span class="ansi-red-fg">         6</span><span class="ansi-red-fg">        16</span>        26        36        46        56<span class="ansi-red-fg">        66</span><span class="ansi-red-fg">        76</span>
<span class="ansi-red-fg">         5</span><span class="ansi-red-fg">        15</span>        25        35        45        55<span class="ansi-red-fg">        65</span><span class="ansi-red-fg">        75</span>
<span class="ansi-red-fg">         4</span><span class="ansi-red-fg">        14</span>        24        34        44        54<span class="ansi-red-fg">        64</span><span class="ansi-red-fg">        74</span>
<span class="ansi-red-fg">         3</span><span class="ansi-red-fg">        13</span>        23        33         0        53<span class="ansi-red-fg">        63</span><span class="ansi-red-fg">        73</span>
<span class="ansi-red-fg">         2</span><span class="ansi-red-fg">        12</span>        22        32        42        52<span class="ansi-red-fg">        62</span><span class="ansi-red-fg">        72</span>
<span class="ansi-red-fg">         1</span><span class="ansi-red-fg">        11</span><span class="ansi-red-fg">        21</span><span class="ansi-red-fg">        31</span><span class="ansi-red-fg">        41</span><span class="ansi-red-fg">        51</span><span class="ansi-red-fg">        61</span><span class="ansi-red-fg">        71</span>
<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">        10</span><span class="ansi-red-fg">        20</span><span class="ansi-red-fg">        30</span><span class="ansi-red-fg">        40</span><span class="ansi-red-fg">        50</span><span class="ansi-red-fg">        60</span><span class="ansi-red-fg">        70</span>

         ^ y
         |
         +---&gt; x

</pre></div></div>
</div>
<p>Here, since d was really a view into <span class="math notranslate nohighlight">\(a_{i+1,j}\)</span>, and we accessed element (1,1) into that view (with 0,0 as the origin), we were really accessing the element (2,1) in the valid region</p>
</section>
<section id="Differencing">
<h2>Differencing<a class="headerlink" href="#Differencing" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ArrayIndexer</span></code> objects are easy to use to construct differences, like those that appear in a stencil for a finite-difference, without having to explicitly loop over the elements of the array.</p>
<p>Here’s we’ll create a new dataset that is initialized with a sine function</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">patch</span><span class="o">.</span><span class="n">Grid2d</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">ng</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">patch</span><span class="o">.</span><span class="n">CellCenterData2d</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="n">bc</span> <span class="o">=</span> <span class="n">bnd</span><span class="o">.</span><span class="n">BC</span><span class="p">(</span><span class="n">xlb</span><span class="o">=</span><span class="s2">&quot;periodic&quot;</span><span class="p">,</span> <span class="n">xrb</span><span class="o">=</span><span class="s2">&quot;periodic&quot;</span><span class="p">,</span> <span class="n">ylb</span><span class="o">=</span><span class="s2">&quot;periodic&quot;</span><span class="p">,</span> <span class="n">yrb</span><span class="o">=</span><span class="s2">&quot;periodic&quot;</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">register_var</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">bc</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">get_var</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="n">a</span><span class="p">[:,:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">a</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">x2d</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">fill_BC</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Our grid object can provide us with a scratch array (an <code class="docutils literal notranslate"><span class="pre">ArrayIndexer</span></code> object) define on the same grid</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">scratch_array</span><span class="p">()</span>
<span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
pyro.mesh.array_indexer.ArrayIndexer
</pre></div></div>
</div>
<p>We can then fill the data in this array with differenced data from our original array – since <code class="docutils literal notranslate"><span class="pre">b</span></code> has a separate data region in memory, its elements are independent of <code class="docutils literal notranslate"><span class="pre">a</span></code>. We do need to make sure that we have the same number of elements on the left and right of the <code class="docutils literal notranslate"><span class="pre">=</span></code>. Since by default, <code class="docutils literal notranslate"><span class="pre">ip()</span></code> will return a view with the same size as the valid region, we can use <code class="docutils literal notranslate"><span class="pre">.v()</span></code> on the left to accept the differences.</p>
<p>Here we compute a centered-difference approximation to the first derivative</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">v</span><span class="p">()[:,:]</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">ip</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">ip</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">a</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">dx</span><span class="p">)</span>
<span class="c1"># normalization was 2.0*pi</span>
<span class="n">b</span><span class="p">[:,:]</span> <span class="o">/=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">ilo</span><span class="p">:</span><span class="n">g</span><span class="o">.</span><span class="n">ihi</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">ilo</span><span class="p">:</span><span class="n">g</span><span class="o">.</span><span class="n">ihi</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">jc</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">ilo</span><span class="p">:</span><span class="n">g</span><span class="o">.</span><span class="n">ihi</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">ilo</span><span class="p">:</span><span class="n">g</span><span class="o">.</span><span class="n">ihi</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">jc</span><span class="p">])</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">dx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.125
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/mesh-examples_46_1.png" src="_images/mesh-examples_46_1.png" />
</div>
</div>
</section>
<section id="Coarsening-and-prolonging">
<h2>Coarsening and prolonging<a class="headerlink" href="#Coarsening-and-prolonging" title="Link to this heading">#</a></h2>
<p>we can get a new <code class="docutils literal notranslate"><span class="pre">ArrayIndexer</span></code> object on a coarser grid for one of our variables</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>
<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>
<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>   0.65328   0.65328  -0.65328  -0.65328<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>
<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>   0.65328   0.65328  -0.65328  -0.65328<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>
<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>   0.65328   0.65328  -0.65328  -0.65328<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>
<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>   0.65328   0.65328  -0.65328  -0.65328<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>
<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>
<span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span><span class="ansi-red-fg">         0</span>

         ^ y
         |
         +---&gt; x

</pre></div></div>
</div>
<p>or a finer grid</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">prolong</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%6.2g</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>
<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>
<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>  0.22  0.55  0.86  0.99  0.99  0.86  0.55  0.22 -0.22 -0.55 -0.86 -0.99 -0.99 -0.86 -0.55 -0.22<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>
<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>  0.22  0.55  0.86  0.99  0.99  0.86  0.55  0.22 -0.22 -0.55 -0.86 -0.99 -0.99 -0.86 -0.55 -0.22<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>
<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>  0.22  0.55  0.86  0.99  0.99  0.86  0.55  0.22 -0.22 -0.55 -0.86 -0.99 -0.99 -0.86 -0.55 -0.22<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>
<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>  0.22  0.55  0.86  0.99  0.99  0.86  0.55  0.22 -0.22 -0.55 -0.86 -0.99 -0.99 -0.86 -0.55 -0.22<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>
<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>  0.22  0.55  0.86  0.99  0.99  0.86  0.55  0.22 -0.22 -0.55 -0.86 -0.99 -0.99 -0.86 -0.55 -0.22<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>
<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>  0.22  0.55  0.86  0.99  0.99  0.86  0.55  0.22 -0.22 -0.55 -0.86 -0.99 -0.99 -0.86 -0.55 -0.22<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>
<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>  0.22  0.55  0.86  0.99  0.99  0.86  0.55  0.22 -0.22 -0.55 -0.86 -0.99 -0.99 -0.86 -0.55 -0.22<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>
<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>  0.22  0.55  0.86  0.99  0.99  0.86  0.55  0.22 -0.22 -0.55 -0.86 -0.99 -0.99 -0.86 -0.55 -0.22<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>
<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>  0.22  0.55  0.86  0.99  0.99  0.86  0.55  0.22 -0.22 -0.55 -0.86 -0.99 -0.99 -0.86 -0.55 -0.22<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>
<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>  0.22  0.55  0.86  0.99  0.99  0.86  0.55  0.22 -0.22 -0.55 -0.86 -0.99 -0.99 -0.86 -0.55 -0.22<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>
<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>  0.22  0.55  0.86  0.99  0.99  0.86  0.55  0.22 -0.22 -0.55 -0.86 -0.99 -0.99 -0.86 -0.55 -0.22<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>
<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>  0.22  0.55  0.86  0.99  0.99  0.86  0.55  0.22 -0.22 -0.55 -0.86 -0.99 -0.99 -0.86 -0.55 -0.22<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>
<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>  0.22  0.55  0.86  0.99  0.99  0.86  0.55  0.22 -0.22 -0.55 -0.86 -0.99 -0.99 -0.86 -0.55 -0.22<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>
<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>  0.22  0.55  0.86  0.99  0.99  0.86  0.55  0.22 -0.22 -0.55 -0.86 -0.99 -0.99 -0.86 -0.55 -0.22<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>
<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>  0.22  0.55  0.86  0.99  0.99  0.86  0.55  0.22 -0.22 -0.55 -0.86 -0.99 -0.99 -0.86 -0.55 -0.22<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>
<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>  0.22  0.55  0.86  0.99  0.99  0.86  0.55  0.22 -0.22 -0.55 -0.86 -0.99 -0.99 -0.86 -0.55 -0.22<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>
<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>
<span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span><span class="ansi-red-fg">     0</span>

         ^ y
         |
         +---&gt; x

</pre></div></div>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="mesh_basics.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Mesh overview</p>
      </div>
    </a>
    <a class="right-next"
       href="spherical-mesh.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Spherical Polar Grid</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Setup-a-Grid-with-Variables">Setup a Grid with Variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Working-with-the-data">Working with the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ArrayIndexer"><code class="docutils literal notranslate"><span class="pre">ArrayIndexer</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Differencing">Differencing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Coarsening-and-prolonging">Coarsening and prolonging</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By pyro development team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, pyro development team.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>