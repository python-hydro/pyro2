<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mesh overview &mdash; pyro 4.1.0.post2+g493774e1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/theme_overrides.css?v=2e394b92" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=ffe0fef8"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="_static/copybutton.js?v=f281be69"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Mesh examples" href="mesh-examples.html" />
    <link rel="prev" title="Adding a problem" href="problems.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            pyro
              <img src="_static/logo.gif" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                4.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">pyro basics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction to pyro</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Setting up pyro</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes.html">Notes on the numerical methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html">Design ideas</a></li>
<li class="toctree-l1"><a class="reference internal" href="running.html">Running</a></li>
<li class="toctree-l1"><a class="reference internal" href="output.html">Working with output</a></li>
<li class="toctree-l1"><a class="reference internal" href="problems.html">Adding a problem</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Mesh overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#mesh-patch-implementation-and-use"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mesh.patch</span></code> implementation and use</a></li>
<li class="toctree-l2"><a class="reference internal" href="#jupyter-notebook">Jupyter notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tests">Tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mesh-examples.html">Mesh examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Solvers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="advection_basics.html">Advection solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="burgers_basics.html">Burgers’ Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="compressible_basics.html">Compressible hydrodynamics solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="compressible_compare.html">Compressible solver comparisons</a></li>
<li class="toctree-l1"><a class="reference internal" href="multigrid.html">Multigrid Solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="diffusion_basics.html">Diffusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="incompressible_basics.html">Incompressible hydrodynamics solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="incompressible_viscous_basics.html">Incompressible viscous hydrodynamics solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="lowmach_basics.html">Low Mach number hydrodynamics solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="swe_basics.html">Shallow water solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="particles_basics.html">Particles</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="analysis.html">Analysis routines</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="help.html">Contributing and getting help</a></li>
<li class="toctree-l1"><a class="reference internal" href="ack.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="ack.html#history">History</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Software Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyro</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Mesh overview</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/mesh_basics.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mesh-overview">
<h1>Mesh overview<a class="headerlink" href="#mesh-overview" title="Link to this heading"></a></h1>
<p>All solvers are based on a finite-volume/cell-centered
discretization. The basic theory of such methods is discussed in
<a class="reference internal" href="notes.html#notes"><span class="std std-ref">Notes on the numerical methods</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The core data structure that holds data on the grid is
<a class="reference internal" href="pyro.mesh.html#pyro.mesh.patch.CellCenterData2d" title="pyro.mesh.patch.CellCenterData2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">CellCenterData2d</span></code></a>.  This does
not distinguish between cell-centered data and cell-averages.  This
is fine for methods that are second-order accurate, but for
higher-order methods, the <a class="reference internal" href="pyro.mesh.html#pyro.mesh.fv.FV2d" title="pyro.mesh.fv.FV2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">FV2d</span></code></a> class has
methods for converting between the two data centerings.</p>
</div>
<section id="mesh-patch-implementation-and-use">
<h2><a class="reference internal" href="pyro.mesh.html#module-pyro.mesh.patch" title="pyro.mesh.patch"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mesh.patch</span></code></a> implementation and use<a class="headerlink" href="#mesh-patch-implementation-and-use" title="Link to this heading"></a></h2>
<p>We import the basic mesh functionality as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyro.mesh.patch</span> <span class="k">as</span> <span class="nn">patch</span>
<span class="kn">import</span> <span class="nn">pyro.mesh.fv</span> <span class="k">as</span> <span class="nn">fv</span>
<span class="kn">import</span> <span class="nn">pyro.mesh.boundary</span> <span class="k">as</span> <span class="nn">bnd</span>
<span class="kn">import</span> <span class="nn">pyro.mesh.array_indexer</span> <span class="k">as</span> <span class="nn">ai</span>
</pre></div>
</div>
<p>There are several main objects in the patch class that we interact with:</p>
<ul class="simple">
<li><p><a class="reference internal" href="pyro.mesh.html#pyro.mesh.patch.Grid2d" title="pyro.mesh.patch.Grid2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">patch.Grid2d</span></code></a>: this is the main grid
object. It is basically a container that holds the number of zones
in each coordinate direction, the domain extrema, and the
coordinates of the zones themselves (both at the edges and center).</p></li>
<li><p><a class="reference internal" href="pyro.mesh.html#pyro.mesh.patch.CellCenterData2d" title="pyro.mesh.patch.CellCenterData2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">patch.CellCenterData2d</span></code></a>: this
is the main data object—it holds cell-centered data on a grid.  To
build a <a class="reference internal" href="pyro.mesh.html#pyro.mesh.patch.CellCenterData2d" title="pyro.mesh.patch.CellCenterData2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">patch.CellCenterData2d</span></code></a>
object you need to pass in the <a class="reference internal" href="pyro.mesh.html#pyro.mesh.patch.Grid2d" title="pyro.mesh.patch.Grid2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">patch.Grid2d</span></code></a>
object that defines the mesh. The
<a class="reference internal" href="pyro.mesh.html#pyro.mesh.patch.CellCenterData2d" title="pyro.mesh.patch.CellCenterData2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">patch.CellCenterData2d</span></code></a> object then
allocates storage for the unknowns that live on the grid. This class
also provides methods to fill boundary conditions, retrieve the data
in different fashions, and read and write the object from/to disk.</p></li>
<li><p><a class="reference internal" href="pyro.mesh.html#pyro.mesh.fv.FV2d" title="pyro.mesh.fv.FV2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">fv.FV2d</span></code></a>: this is a special class derived from
<a class="reference internal" href="pyro.mesh.html#pyro.mesh.patch.CellCenterData2d" title="pyro.mesh.patch.CellCenterData2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">patch.CellCenterData2d</span></code></a> that implements some extra functions
needed to convert between cell-center data and averages with
fourth-order accuracy.</p></li>
<li><p><a class="reference internal" href="pyro.mesh.html#pyro.mesh.boundary.BC" title="pyro.mesh.boundary.BC"><code class="xref py py-func docutils literal notranslate"><span class="pre">bnd.BC</span></code></a>: This is simply a container that
holds the names of the boundary conditions on each edge of the
domain.</p></li>
<li><p><a class="reference internal" href="pyro.mesh.html#pyro.mesh.array_indexer.ArrayIndexer" title="pyro.mesh.array_indexer.ArrayIndexer"><code class="xref py py-func docutils literal notranslate"><span class="pre">ai.ArrayIndexer</span></code></a>: This is a
class that subclasses the NumPy ndarray and makes the data in the
array know about the details of the grid it is defined on. In
particular, it knows which cells are valid and which are the ghost
cells, and it has methods to do the <span class="math notranslate nohighlight">\(a_{i+1,j}\)</span> operations that are
common in difference methods.</p></li>
<li><p><a class="reference internal" href="pyro.mesh.html#pyro.mesh.integration.RKIntegrator" title="pyro.mesh.integration.RKIntegrator"><code class="xref py py-func docutils literal notranslate"><span class="pre">integration.RKIntegrator</span></code></a>:
This class implements Runge-Kutta integration in time by managing a
hierarchy of grids at different time-levels.  A Butcher tableau
provides the weights and evaluation points for the different stages
that make up the integration.</p></li>
</ul>
<p>The procedure for setting up a grid and the data that lives on it is as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">myg</span> <span class="o">=</span> <span class="n">patch</span><span class="o">.</span><span class="n">Grid2d</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</pre></div>
</div>
<p>This creates the 2-d grid object <code class="docutils literal notranslate"><span class="pre">myg</span></code> with 16 zones in the x-direction
and 32 zones in the y-direction. It also specifies the physical
coordinate of the rightmost edge in x and y.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mydata</span> <span class="o">=</span> <span class="n">patch</span><span class="o">.</span><span class="n">CellCenterData2d</span><span class="p">(</span><span class="n">myg</span><span class="p">)</span>

<span class="n">bc</span> <span class="o">=</span> <span class="n">bnd</span><span class="o">.</span><span class="n">BC</span><span class="p">(</span><span class="n">xlb</span><span class="o">=</span><span class="s2">&quot;periodic&quot;</span><span class="p">,</span> <span class="n">xrb</span><span class="o">=</span><span class="s2">&quot;periodic&quot;</span><span class="p">,</span> <span class="n">ylb</span><span class="o">=</span><span class="s2">&quot;reflect-even&quot;</span><span class="p">,</span> <span class="n">yrb</span><span class="o">=</span><span class="s2">&quot;outflow&quot;</span><span class="p">)</span>

<span class="n">mydata</span><span class="o">.</span><span class="n">register_var</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">bc</span><span class="p">)</span>
<span class="n">mydata</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
</pre></div>
</div>
<p>This creates the cell-centered data object, <code class="docutils literal notranslate"><span class="pre">mydata</span></code>, that lives on the
grid we just built above. Next we create a boundary condition object,
specifying the type of boundary conditions for each edge of the
domain, and finally use this to register a variable, <code class="docutils literal notranslate"><span class="pre">a</span></code> that lives on
the grid. Once we call the <code class="docutils literal notranslate"><span class="pre">create()</span></code> method, the storage for the
variables is allocated and we can no longer add variables to the grid.
Note that each variable needs to specify a BC—this allows us to do
different actions for each variable (for example, some may do even
reflection while others may do odd reflection).</p>
</section>
<section id="jupyter-notebook">
<h2>Jupyter notebook<a class="headerlink" href="#jupyter-notebook" title="Link to this heading"></a></h2>
<p>A Jupyter notebook that illustrates some of the basics of working with
the grid is provided as <a class="reference external" href="https://github.com/python-hydro/pyro2/blob/main/pyro/mesh/mesh-examples.ipynb">mesh-examples.ipynb</a>. This will
demonstrate, for example, how to use the <a class="reference internal" href="pyro.mesh.html#pyro.mesh.array_indexer.ArrayIndexer" title="pyro.mesh.array_indexer.ArrayIndexer"><code class="xref py py-func docutils literal notranslate"><span class="pre">ArrayIndexer</span></code></a> methods to
construct differences.</p>
</section>
<section id="tests">
<h2>Tests<a class="headerlink" href="#tests" title="Link to this heading"></a></h2>
<p>The actual filling of the boundary conditions is done by the <a class="reference internal" href="pyro.mesh.html#pyro.mesh.patch.CellCenterData2d.fill_BC" title="pyro.mesh.patch.CellCenterData2d.fill_BC"><code class="xref py py-func docutils literal notranslate"><span class="pre">fill_BC</span></code></a>
method. The script <code class="docutils literal notranslate"><span class="pre">bc_demo.py</span></code> tests the various types of boundary
conditions by initializing a small grid with sequential data, filling
the BCs, and printing out the results.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="problems.html" class="btn btn-neutral float-left" title="Adding a problem" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mesh-examples.html" class="btn btn-neutral float-right" title="Mesh examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, pyro development team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>