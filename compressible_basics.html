
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Compressible hydrodynamics &#8212; pyro 4.4.0.post5+gdcbf3fbf documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/myfile.css?v=359afcf4" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/documentation_options.js?v=149ddbc7"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["\\(", "\\)"]], "processEscapes": true, "displayMath": [["\\[", "\\]"]]}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'compressible_basics';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Diffusion" href="diffusion_basics.html" />
    <link rel="prev" title="Burgers’ Equation" href="burgers_basics.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="4.4" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.gif" class="logo__image only-light" alt=""/>
    <img src="_static/logo.gif" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">pyro 4.4</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">pyro basics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction to pyro</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Setting up pyro</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes.html">Notes on the numerical methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html">Design ideas</a></li>
<li class="toctree-l1"><a class="reference internal" href="running.html">Running</a></li>
<li class="toctree-l1"><a class="reference internal" href="output.html">Working with output</a></li>
<li class="toctree-l1"><a class="reference internal" href="problems.html">Adding a problem</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Mesh</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="mesh_basics.html">Mesh overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="mesh-examples.html">Mesh examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="spherical-mesh.html">Spherical Polar Grid</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Multigrid</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="multigrid.html">Multigrid Solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="multigrid_basics.html">Simple Multigrid Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="multigrid-constant-coefficients.html">Constant-Coefficient Poisson Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="multigrid-variable-coeff.html">Variable Coefficient Poisson</a></li>
<li class="toctree-l1"><a class="reference internal" href="multigrid-general-linear.html">General Linear Elliptic Equation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Hydro Solvers</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="advection_basics.html">Advection</a></li>
<li class="toctree-l1"><a class="reference internal" href="burgers_basics.html">Burgers’ Equation</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Compressible hydrodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="diffusion_basics.html">Diffusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="incompressible_basics.html">Incompressible hydrodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="lowmach_basics.html">Low Mach number hydrodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="swe_basics.html">Shallow water hydrodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="particles_basics.html">Particles</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="compressible-rt-compare.html">Comparing the Compressible Solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="adding_a_problem_jupyter.html">Defining our own problem in Jupyter</a></li>
<li class="toctree-l1"><a class="reference internal" href="advection-error.html">Error Measurement of the <code class="docutils literal notranslate"><span class="pre">advection_fv4</span></code> Solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="compressible-convergence.html">Convergence of the compressible solvers</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Utilities</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="analysis.html">Analysis routines</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="help.html">Contributing and getting help</a></li>
<li class="toctree-l1"><a class="reference internal" href="ack.html">Acknowledgments</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Software Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="modules.html">API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="pyro.html">pyro package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.advection.html">pyro.advection package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.advection.problems.html">pyro.advection.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.advection_fv4.html">pyro.advection_fv4 package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.advection_fv4.problems.html">pyro.advection_fv4.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.advection_nonuniform.html">pyro.advection_nonuniform package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.advection_nonuniform.problems.html">pyro.advection_nonuniform.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.advection_rk.html">pyro.advection_rk package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.advection_rk.problems.html">pyro.advection_rk.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.advection_weno.html">pyro.advection_weno package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.advection_weno.problems.html">pyro.advection_weno.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.burgers.html">pyro.burgers package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.burgers.problems.html">pyro.burgers.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.burgers_viscous.html">pyro.burgers_viscous package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.burgers_viscous.problems.html">pyro.burgers_viscous.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.compressible.html">pyro.compressible package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.compressible.problems.html">pyro.compressible.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.compressible_fv4.html">pyro.compressible_fv4 package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.compressible_fv4.problems.html">pyro.compressible_fv4.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.compressible_react.html">pyro.compressible_react package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.compressible_react.problems.html">pyro.compressible_react.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.compressible_rk.html">pyro.compressible_rk package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.compressible_rk.problems.html">pyro.compressible_rk.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.compressible_sdc.html">pyro.compressible_sdc package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.compressible_sdc.problems.html">pyro.compressible_sdc.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.diffusion.html">pyro.diffusion package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.diffusion.problems.html">pyro.diffusion.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.incompressible.html">pyro.incompressible package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.incompressible.problems.html">pyro.incompressible.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.incompressible_viscous.html">pyro.incompressible_viscous package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.incompressible_viscous.problems.html">pyro.incompressible_viscous.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.lm_atm.html">pyro.lm_atm package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.lm_atm.problems.html">pyro.lm_atm.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="pyro.mesh.html">pyro.mesh package</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.multigrid.html">pyro.multigrid package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.multigrid.examples.html">pyro.multigrid.examples package</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="pyro.particles.html">pyro.particles package</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="pyro.swe.html">pyro.swe package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="pyro.swe.problems.html">pyro.swe.problems package</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="pyro.util.html">pyro.util package</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/python-hydro/pyro2" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/python-hydro/pyro2/blob/main/docs/source/compressible_basics.rst?plain=1" target="_blank"
   class="btn btn-sm btn-source-file-button dropdown-item"
   title="Show source"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">Show source</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/python-hydro/pyro2/edit/main/docs/source/compressible_basics.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/python-hydro/pyro2/issues/new?title=Issue%20on%20page%20%2Fcompressible_basics.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/compressible_basics.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Compressible hydrodynamics</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compressible-solver"><code class="docutils literal notranslate"><span class="pre">compressible</span></code> solver</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#supported-problems">supported problems</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#acoustic-pulse"><code class="docutils literal notranslate"><span class="pre">acoustic_pulse</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#advect"><code class="docutils literal notranslate"><span class="pre">advect</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bubble"><code class="docutils literal notranslate"><span class="pre">bubble</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#convection"><code class="docutils literal notranslate"><span class="pre">convection</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#gresho"><code class="docutils literal notranslate"><span class="pre">gresho</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#heating"><code class="docutils literal notranslate"><span class="pre">heating</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hse"><code class="docutils literal notranslate"><span class="pre">hse</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#kh"><code class="docutils literal notranslate"><span class="pre">kh</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#logo"><code class="docutils literal notranslate"><span class="pre">logo</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plume"><code class="docutils literal notranslate"><span class="pre">plume</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#quad"><code class="docutils literal notranslate"><span class="pre">quad</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ramp"><code class="docutils literal notranslate"><span class="pre">ramp</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#rt"><code class="docutils literal notranslate"><span class="pre">rt</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#rt2"><code class="docutils literal notranslate"><span class="pre">rt2</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sedov"><code class="docutils literal notranslate"><span class="pre">sedov</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sod"><code class="docutils literal notranslate"><span class="pre">sod</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#test"><code class="docutils literal notranslate"><span class="pre">test</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compressible-rk-solver"><code class="docutils literal notranslate"><span class="pre">compressible_rk</span></code> solver</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">supported problems</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compressible-fv4-solver"><code class="docutils literal notranslate"><span class="pre">compressible_fv4</span></code> solver</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">supported problems</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compressible-sdc-solver"><code class="docutils literal notranslate"><span class="pre">compressible_sdc</span></code> solver</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">supported problems</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problems">Example problems</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Sod</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Sedov</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">quad</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">rt</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">bubble</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#explorations">Explorations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extensions">Extensions</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="compressible-hydrodynamics">
<h1>Compressible hydrodynamics<a class="headerlink" href="#compressible-hydrodynamics" title="Link to this heading">#</a></h1>
<p>The Euler equations of compressible hydrodynamics take the form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho U) &amp;= 0 \\
\frac{\partial (\rho U)}{\partial t} + \nabla \cdot (\rho U U) + \nabla p &amp;= \rho g \\
\frac{\partial (\rho E)}{\partial t} + \nabla \cdot [(\rho E + p ) U] &amp;= \rho U \cdot g\end{split}\]</div>
<p>with <span class="math notranslate nohighlight">\(\rho E = \rho e + \frac{1}{2} \rho |U|^2\)</span> and <span class="math notranslate nohighlight">\(p =
p(\rho, e)\)</span>.  Note these do not include any dissipation terms, since
they are usually negligible in astrophysics.</p>
<p>pyro has several compressible solvers to solve this equation set.
The implementations here have flattening at shocks, artificial
viscosity, a simple gamma-law equation of state, and (in some cases) a
choice of Riemann solvers. Optional constant gravity in the vertical
direction is allowed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All the compressible solvers share the same <code class="docutils literal notranslate"><span class="pre">problems/</span></code>
directory, which lives in <code class="docutils literal notranslate"><span class="pre">compressible/problems/</span></code>.  For the
other compressible solvers, we simply use a symbolic-link to this
directory in the solver’s directory.</p>
</div>
<section id="compressible-solver">
<h2><code class="docutils literal notranslate"><span class="pre">compressible</span></code> solver<a class="headerlink" href="#compressible-solver" title="Link to this heading">#</a></h2>
<p><a class="reference internal" href="pyro.compressible.html#module-pyro.compressible" title="pyro.compressible"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyro.compressible</span></code></a> is based on a directionally unsplit (the corner
transport upwind algorithm) piecewise linear method for the Euler
equations, following <span id="id1">[<a class="reference internal" href="zreferences.html#id2" title="P. Colella. Multidimensional upwind methods for hyperbolic conservation laws. Journal of Computational Physics, 87:171-200, March 1990. doi:10.1016/0021-9991(90)90233-Q.">Colella90</a>]</span>.  This is overall second-order
accurate.</p>
<p>The parameters for this solver are:</p>
<ul>
<li><p>section: <code class="docutils literal notranslate"><span class="pre">[compressible]</span></code></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">use_flattening</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td><p>apply flattening at shocks (1)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">z0</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.75</span></code></p></td>
<td><p>flattening z0 parameter</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">z1</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.85</span></code></p></td>
<td><p>flattening z1 parameter</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delta</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.33</span></code></p></td>
<td><p>flattening delta parameter</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cvisc</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.1</span></code></p></td>
<td><p>artificial viscosity coefficient</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">limiter</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p></td>
<td><p>limiter (0 = none, 1 = 2nd order, 2 = 4th order)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">grav</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.0</span></code></p></td>
<td><p>gravitational acceleration (in y-direction)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">riemann</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">HLLC</span></code></p></td>
<td><p>HLLC or CGF</p></td>
</tr>
</tbody>
</table>
</div>
</li>
<li><p>section: <code class="docutils literal notranslate"><span class="pre">[driver]</span></code></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cfl</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.8</span></code></p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</li>
<li><p>section: <code class="docutils literal notranslate"><span class="pre">[eos]</span></code></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">gamma</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1.4</span></code></p></td>
<td><p>pres = rho ener (gamma - 1)</p></td>
</tr>
</tbody>
</table>
</div>
</li>
<li><p>section: <code class="docutils literal notranslate"><span class="pre">[particles]</span></code></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">do_particles</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">particle_generator</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">grid</span></code></p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
<section id="supported-problems">
<h3>supported problems<a class="headerlink" href="#supported-problems" title="Link to this heading">#</a></h3>
<section id="acoustic-pulse">
<h4><code class="docutils literal notranslate"><span class="pre">acoustic_pulse</span></code><a class="headerlink" href="#acoustic-pulse" title="Link to this heading">#</a></h4>
<p>The acoustic pulse problem described in McCorquodale &amp; Colella
2011.  This uses a uniform background and a small pressure
perturbation that drives a low Mach number soundwave.  This problem is
useful for testing convergence of a compressible solver.</p>
<p>parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">acoustic_pulse.rho0</span></code></p></td>
<td><p>1.4</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">acoustic_pulse.drho0</span></code></p></td>
<td><p>0.14</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="advect">
<h4><code class="docutils literal notranslate"><span class="pre">advect</span></code><a class="headerlink" href="#advect" title="Link to this heading">#</a></h4>
<p>A simple advection test.  A density perturbation is set with a
constant pressure in the domain and a velocity field is set to advect
the profile across the domain.  This is useful for testing
convergence.</p>
</section>
<section id="bubble">
<h4><code class="docutils literal notranslate"><span class="pre">bubble</span></code><a class="headerlink" href="#bubble" title="Link to this heading">#</a></h4>
<p>A buoyant perturbation (bubble) is placed in an isothermal
hydrostatic atmosphere (plane-parallel).  It will rise and deform (due
to shear)
parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bubble.dens_base</span></code></p></td>
<td><p>10.0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">bubble.scale_height</span></code></p></td>
<td><p>2.0</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bubble.x_pert</span></code></p></td>
<td><p>2.0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">bubble.y_pert</span></code></p></td>
<td><p>2.0</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bubble.r_pert</span></code></p></td>
<td><p>0.25</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">bubble.pert_amplitude_factor</span></code></p></td>
<td><p>5.0</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bubble.dens_cutoff</span></code></p></td>
<td><p>0.01</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="convection">
<h4><code class="docutils literal notranslate"><span class="pre">convection</span></code><a class="headerlink" href="#convection" title="Link to this heading">#</a></h4>
<p>A heat source in a layer at some height above the bottom will drive
convection in an adiabatically stratified atmosphere.
parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">convection.dens_base</span></code></p></td>
<td><p>10.0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">convection.scale_height</span></code></p></td>
<td><p>4.0</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">convection.y_height</span></code></p></td>
<td><p>2.0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">convection.thickness</span></code></p></td>
<td><p>0.25</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">convection.e_rate</span></code></p></td>
<td><p>0.1</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">convection.dens_cutoff</span></code></p></td>
<td><p>0.01</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="gresho">
<h4><code class="docutils literal notranslate"><span class="pre">gresho</span></code><a class="headerlink" href="#gresho" title="Link to this heading">#</a></h4>
<p>The Gresho vortex problem sets up a toroidal velocity field that is
balanced by a radial pressure gradient.  This is in equilibrium and
the state should remain unchanged in time.  This version of the problem
is based on Miczek, Roepke, and Edelmann 2014.
parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">gresho.rho0</span></code></p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">gresho.r</span></code></p></td>
<td><p>0.2</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">gresho.mach</span></code></p></td>
<td><p>0.1</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">gresho.t_r</span></code></p></td>
<td><p>1.0</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="heating">
<h4><code class="docutils literal notranslate"><span class="pre">heating</span></code><a class="headerlink" href="#heating" title="Link to this heading">#</a></h4>
<p>A test of the energy sources.  This uses a uniform domain and
slowly adds heat to the center over time.
parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">heating.rho_ambient</span></code></p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">heating.p_ambient</span></code></p></td>
<td><p>10.0</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">heating.r_src</span></code></p></td>
<td><p>0.1</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">heating.e_rate</span></code></p></td>
<td><p>0.1</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="hse">
<h4><code class="docutils literal notranslate"><span class="pre">hse</span></code><a class="headerlink" href="#hse" title="Link to this heading">#</a></h4>
<p>Initialize an isothermal hydrostatic atmosphere.  It should remain
static.  This is a test of our treatment of the gravitational source
term.
parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hse.dens0</span></code></p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hse.h</span></code></p></td>
<td><p>1.0</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="kh">
<h4><code class="docutils literal notranslate"><span class="pre">kh</span></code><a class="headerlink" href="#kh" title="Link to this heading">#</a></h4>
<p>A Kelvin-Helmholtz shear problem.  There are 2 shear layers, with the and an optional
vertical bulk velocity.  This can be used to test the numerical dissipation in the solver.
This setup is based on McNally et al. 2012.
parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">kh.rho_1</span></code></p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">kh.u_1</span></code></p></td>
<td><p>-1.0</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">kh.rho_2</span></code></p></td>
<td><p>2.0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">kh.u_2</span></code></p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">kh.bulk_velocity</span></code></p></td>
<td><p>0.0</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="logo">
<h4><code class="docutils literal notranslate"><span class="pre">logo</span></code><a class="headerlink" href="#logo" title="Link to this heading">#</a></h4>
<p>Generate the pyro logo!  The word “pyro” is written in the center
of the domain and perturbations are placed in the 4 corners to drive
converging shocks inward to scramble the logo.</p>
</section>
<section id="plume">
<h4><code class="docutils literal notranslate"><span class="pre">plume</span></code><a class="headerlink" href="#plume" title="Link to this heading">#</a></h4>
<p>A heat source at a point creates a plume that buoynantly rises in
an adiabatically stratified atmosphere.
parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">plume.dens_base</span></code></p></td>
<td><p>10.0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">plume.scale_height</span></code></p></td>
<td><p>4.0</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">plume.x_pert</span></code></p></td>
<td><p>2.0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">plume.y_pert</span></code></p></td>
<td><p>2.0</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">plume.r_pert</span></code></p></td>
<td><p>0.25</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">plume.e_rate</span></code></p></td>
<td><p>0.1</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">plume.dens_cutoff</span></code></p></td>
<td><p>0.01</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="quad">
<h4><code class="docutils literal notranslate"><span class="pre">quad</span></code><a class="headerlink" href="#quad" title="Link to this heading">#</a></h4>
<p>The quadrant problem from Shulz-Rinne et al. 1993; Lax and Lui 1998.
Four different states are initialized in the quadrants of the domain, driving
shocks and other hydrodynamic waves at the interfaces.  This can be used to
test the symmetry of the solver.</p>
<p>parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">quadrant.rho1</span></code></p></td>
<td><p>1.5</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">quadrant.u1</span></code></p></td>
<td><p>0.0</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">quadrant.v1</span></code></p></td>
<td><p>0.0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">quadrant.p1</span></code></p></td>
<td><p>1.5</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">quadrant.rho2</span></code></p></td>
<td><p>0.532258064516129</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">quadrant.u2</span></code></p></td>
<td><p>1.206045378311055</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">quadrant.v2</span></code></p></td>
<td><p>0.0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">quadrant.p2</span></code></p></td>
<td><p>0.3</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">quadrant.rho3</span></code></p></td>
<td><p>0.137992831541219</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">quadrant.u3</span></code></p></td>
<td><p>1.206045378311055</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">quadrant.v3</span></code></p></td>
<td><p>1.206045378311055</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">quadrant.p3</span></code></p></td>
<td><p>0.029032258064516</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">quadrant.rho4</span></code></p></td>
<td><p>0.532258064516129</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">quadrant.u4</span></code></p></td>
<td><p>0.0</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">quadrant.v4</span></code></p></td>
<td><p>1.206045378311055</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">quadrant.p4</span></code></p></td>
<td><p>0.3</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">quadrant.cx</span></code></p></td>
<td><p>0.5</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">quadrant.cy</span></code></p></td>
<td><p>0.5</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="ramp">
<h4><code class="docutils literal notranslate"><span class="pre">ramp</span></code><a class="headerlink" href="#ramp" title="Link to this heading">#</a></h4>
<p>A shock hitting a ramp at an oblique angle.  This is based on
Woodward &amp; Colella 1984.
parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ramp.rhol</span></code></p></td>
<td><p>8.0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ramp.ul</span></code></p></td>
<td><p>7.1447096</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ramp.vl</span></code></p></td>
<td><p>-4.125</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ramp.pl</span></code></p></td>
<td><p>116.5</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ramp.rhor</span></code></p></td>
<td><p>1.4</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ramp.ur</span></code></p></td>
<td><p>0.0</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ramp.vr</span></code></p></td>
<td><p>0.0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ramp.pr</span></code></p></td>
<td><p>1.0</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="rt">
<h4><code class="docutils literal notranslate"><span class="pre">rt</span></code><a class="headerlink" href="#rt" title="Link to this heading">#</a></h4>
<p>A single-mode Rayleigh-Taylor instability.
parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rt.dens1</span></code></p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">rt.dens2</span></code></p></td>
<td><p>2.0</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rt.amp</span></code></p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">rt.sigma</span></code></p></td>
<td><p>0.1</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rt.p0</span></code></p></td>
<td><p>10.0</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="rt2">
<h4><code class="docutils literal notranslate"><span class="pre">rt2</span></code><a class="headerlink" href="#rt2" title="Link to this heading">#</a></h4>
<p>A RT problem with two distinct modes: short wavelength on the
left and long wavelength on the right.  This allows one to see
how the growth rate depends on wavenumber.</p>
<p>parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rt2.dens1</span></code></p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">rt2.dens2</span></code></p></td>
<td><p>2.0</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rt2.amp</span></code></p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">rt2.sigma</span></code></p></td>
<td><p>0.1</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rt2.p0</span></code></p></td>
<td><p>10.0</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="sedov">
<h4><code class="docutils literal notranslate"><span class="pre">sedov</span></code><a class="headerlink" href="#sedov" title="Link to this heading">#</a></h4>
<p>The classic Sedov problem.
parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sedov.r_init</span></code></p></td>
<td><p>0.1</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sedov.nsub</span></code></p></td>
<td><p>4</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="sod">
<h4><code class="docutils literal notranslate"><span class="pre">sod</span></code><a class="headerlink" href="#sod" title="Link to this heading">#</a></h4>
<p>A general shock tube problem for comparing the solver to an exact
Riemann solution.
parameters:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sod.direction</span></code></p></td>
<td><p>x</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sod.dens_left</span></code></p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sod.dens_right</span></code></p></td>
<td><p>0.125</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sod.u_left</span></code></p></td>
<td><p>0.0</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sod.u_right</span></code></p></td>
<td><p>0.0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sod.p_left</span></code></p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sod.p_right</span></code></p></td>
<td><p>0.1</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="test">
<h4><code class="docutils literal notranslate"><span class="pre">test</span></code><a class="headerlink" href="#test" title="Link to this heading">#</a></h4>
<p>A setup intended for unit testing.</p>
</section>
</section>
</section>
<section id="compressible-rk-solver">
<h2><code class="docutils literal notranslate"><span class="pre">compressible_rk</span></code> solver<a class="headerlink" href="#compressible-rk-solver" title="Link to this heading">#</a></h2>
<p><a class="reference internal" href="pyro.compressible_rk.html#module-pyro.compressible_rk" title="pyro.compressible_rk"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyro.compressible_rk</span></code></a> uses a method of lines time-integration
approach with piecewise linear spatial reconstruction for the Euler
equations.  This is overall second-order accurate.</p>
<p>The parameters for this solver are:</p>
<ul>
<li><p>section: <code class="docutils literal notranslate"><span class="pre">[compressible]</span></code></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">use_flattening</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td><p>apply flattening at shocks (1)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">z0</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.75</span></code></p></td>
<td><p>flattening z0 parameter</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">z1</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.85</span></code></p></td>
<td><p>flattening z1 parameter</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delta</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.33</span></code></p></td>
<td><p>flattening delta parameter</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cvisc</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.1</span></code></p></td>
<td><p>artificial viscosity coefficient</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">limiter</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p></td>
<td><p>limiter (0 = none, 1 = 2nd order, 2 = 4th order)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">temporal_method</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">RK4</span></code></p></td>
<td><p>integration method (see mesh/integration.py)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">grav</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.0</span></code></p></td>
<td><p>gravitational acceleration (in y-direction)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">riemann</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">HLLC</span></code></p></td>
<td><p>HLLC or CGF</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">well_balanced</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p></td>
<td><p>use a well-balanced scheme to keep the model in
hydrostatic equilibrium</p></td>
</tr>
</tbody>
</table>
</div>
</li>
<li><p>section: <code class="docutils literal notranslate"><span class="pre">[driver]</span></code></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cfl</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.8</span></code></p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</li>
<li><p>section: <code class="docutils literal notranslate"><span class="pre">[eos]</span></code></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">gamma</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1.4</span></code></p></td>
<td><p>pres = rho ener (gamma - 1)</p></td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
<section id="id2">
<h3>supported problems<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">compressible_rk</span></code> uses the problems defined by <code class="docutils literal notranslate"><span class="pre">compressible</span></code>.</p>
</section>
</section>
<section id="compressible-fv4-solver">
<h2><code class="docutils literal notranslate"><span class="pre">compressible_fv4</span></code> solver<a class="headerlink" href="#compressible-fv4-solver" title="Link to this heading">#</a></h2>
<p><a class="reference internal" href="pyro.compressible_fv4.html#module-pyro.compressible_fv4" title="pyro.compressible_fv4"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyro.compressible_fv4</span></code></a> uses a 4th order accurate method with RK4
time integration, following <span id="id3">[<a class="reference internal" href="zreferences.html#id3" title="P. McCorquodale and P. Colella. A high-order finite-volume method for conservation laws on locally refined grids. Communication in Applied Mathematics and Computational Science, 6(1):1–25, 2011.">McCorquodaleColella11</a>]</span>.</p>
<p>The parameter for this solver are:</p>
<ul>
<li><p>section: <code class="docutils literal notranslate"><span class="pre">[compressible]</span></code></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">use_flattening</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td><p>apply flattening at shocks (1)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">z0</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.75</span></code></p></td>
<td><p>flattening z0 parameter</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">z1</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.85</span></code></p></td>
<td><p>flattening z1 parameter</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delta</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.33</span></code></p></td>
<td><p>flattening delta parameter</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cvisc</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.1</span></code></p></td>
<td><p>artificial viscosity coefficient</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">limiter</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p></td>
<td><p>limiter (0 = none, 1 = 2nd order, 2 = 4th order)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">temporal_method</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">RK4</span></code></p></td>
<td><p>integration method (see mesh/integration.py)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">grav</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.0</span></code></p></td>
<td><p>gravitational acceleration (in y-direction)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">riemann</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CGF</span></code></p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</li>
<li><p>section: <code class="docutils literal notranslate"><span class="pre">[driver]</span></code></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cfl</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.8</span></code></p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</li>
<li><p>section: <code class="docutils literal notranslate"><span class="pre">[eos]</span></code></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">gamma</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1.4</span></code></p></td>
<td><p>pres = rho ener (gamma - 1)</p></td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
<section id="id4">
<h3>supported problems<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">compressible_fv4</span></code> uses the problems defined by <code class="docutils literal notranslate"><span class="pre">compressible</span></code>.</p>
</section>
</section>
<section id="compressible-sdc-solver">
<h2><code class="docutils literal notranslate"><span class="pre">compressible_sdc</span></code> solver<a class="headerlink" href="#compressible-sdc-solver" title="Link to this heading">#</a></h2>
<p><a class="reference internal" href="pyro.compressible_sdc.html#module-pyro.compressible_sdc" title="pyro.compressible_sdc"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyro.compressible_sdc</span></code></a> uses a 4th order accurate method with
spectral-deferred correction (SDC) for the time integration.  This
shares much in common with the <a class="reference internal" href="pyro.compressible_fv4.html#module-pyro.compressible_fv4" title="pyro.compressible_fv4"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyro.compressible_fv4</span></code></a> solver, aside from
how the time-integration is handled.</p>
<p>The parameters for this solver are:</p>
<ul>
<li><p>section: <code class="docutils literal notranslate"><span class="pre">[compressible]</span></code></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">use_flattening</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td><p>apply flattening at shocks (1)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">z0</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.75</span></code></p></td>
<td><p>flattening z0 parameter</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">z1</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.85</span></code></p></td>
<td><p>flattening z1 parameter</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delta</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.33</span></code></p></td>
<td><p>flattening delta parameter</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cvisc</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.1</span></code></p></td>
<td><p>artificial viscosity coefficient</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">limiter</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p></td>
<td><p>limiter (0 = none, 1 = 2nd order, 2 = 4th order)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">temporal_method</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">RK4</span></code></p></td>
<td><p>integration method (see mesh/integration.py)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">grav</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.0</span></code></p></td>
<td><p>gravitational acceleration (in y-direction)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">riemann</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CGF</span></code></p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</li>
<li><p>section: <code class="docutils literal notranslate"><span class="pre">[driver]</span></code></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cfl</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.8</span></code></p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</li>
<li><p>section: <code class="docutils literal notranslate"><span class="pre">[eos]</span></code></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>option</p></th>
<th class="head"><p>value</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">gamma</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1.4</span></code></p></td>
<td><p>pres = rho ener (gamma - 1)</p></td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
<section id="id5">
<h3>supported problems<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">compressible_sdc</span></code> uses the problems defined by <code class="docutils literal notranslate"><span class="pre">compressible</span></code>.</p>
</section>
</section>
<section id="example-problems">
<h2>Example problems<a class="headerlink" href="#example-problems" title="Link to this heading">#</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The 4th-order accurate solver (<a class="reference internal" href="pyro.compressible_fv4.html#module-pyro.compressible_fv4" title="pyro.compressible_fv4"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyro.compressible_fv4</span></code></a>) requires that
the initialization create cell-averages accurate to 4th-order.  To
allow for all the solvers to use the same problem setups, we assume
that the initialization routines initialize cell-centers (which is
fine for 2nd-order accuracy), and the
<a class="reference internal" href="pyro.compressible_fv4.html#pyro.compressible_fv4.simulation.Simulation.preevolve" title="pyro.compressible_fv4.simulation.Simulation.preevolve"><code class="xref py py-func docutils literal notranslate"><span class="pre">preevolve()</span></code></a> method will convert
these to cell-averages automatically after initialization.</p>
</div>
<section id="id6">
<h3>Sod<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>The Sod problem is a standard hydrodynamics problem. It is a
one-dimensional shock tube (two states separated by an interface),
that exhibits all three hydrodynamic waves: a shock, contact, and
rarefaction. Furthermore, there are exact solutions for a gamma-law
equation of state, so we can check our solution against these exact
solutions. See Toro’s book for details on this problem and the exact
Riemann solver.</p>
<p>Because it is one-dimensional, we run it in narrow domains in the x- or y-directions. It can be run as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><style type="text/css">
span.prompt1:before {
  content: "$ ";
}
</style><span class="prompt1">pyro_sim.py<span class="w"> </span>compressible<span class="w"> </span>sod<span class="w"> </span>inputs.sod.x</span>
<span class="prompt1">pyro_sim.py<span class="w"> </span>compressible<span class="w"> </span>sod<span class="w"> </span>inputs.sod.y</span>
</pre></div></div><p>A simple script, <code class="docutils literal notranslate"><span class="pre">sod_compare.py</span></code> in <code class="docutils literal notranslate"><span class="pre">analysis/</span></code> will read a pyro output
file and plot the solution over the exact Sod solution. Below we see
the result for a Sod run with 128 points in the x-direction, gamma =
1.4, and run until t = 0.2 s.</p>
<img alt="_images/sod_compare.png" class="align-center" src="_images/sod_compare.png" />
<p>We see excellent agreement for all quantities. The shock wave is very
steep, as expected. The contact wave is smeared out over ~5 zones—this
is discussed in the notes above, and can be improved in the PPM method
with contact steepening.</p>
</section>
<section id="id7">
<h3>Sedov<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<p>The Sedov blast wave problem is another standard test with an analytic
solution (Sedov 1959). A lot of energy is point into a point in a
uniform medium and a blast wave propagates outward. The Sedov problem
is run as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">pyro_sim.py<span class="w"> </span>compressible<span class="w"> </span>sedov<span class="w"> </span>inputs.sedov</span>
</pre></div></div><p>The video below shows the output from a 128 x 128 grid with the energy
put in a radius of 0.0125 surrounding the center of the domain. A
gamma-law EOS with gamma = 1.4 is used, and we run until 0.1</p>
<div style="position: relative; padding-bottom: 75%; height: 0; overflow: hidden; max-width: 100%; height: auto;">
    <iframe src="https://www.youtube.com/embed/1JO6By78p9E?rel=0" frameborder="0" allowfullscreen style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"></iframe>
</div><br><p>We see some grid effects because it is hard to initialize a small
circular explosion on a rectangular grid. To compare to the analytic
solution, we need to radially bin the data. Since this is a 2-d
explosion, the physical geometry it represents is a cylindrical blast
wave, so we compare to Sedov’s cylindrical solution. The radial
binning is done with the <code class="docutils literal notranslate"><span class="pre">sedov_compare.py</span></code> script in <code class="docutils literal notranslate"><span class="pre">analysis/</span></code></p>
<img alt="_images/sedov_compare.png" class="align-center" src="_images/sedov_compare.png" />
<p>This shows good agreement with the analytic solution.</p>
</section>
<section id="id8">
<h3>quad<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<p>The quad problem sets up different states in four regions of the
domain and watches the complex interfaces that develop as shocks
interact. This problem has appeared in several places (and a <a class="reference external" href="http://planets.utsc.utoronto.ca/~pawel/Riemann.hydro.html">detailed
investigation</a> is
online by Pawel Artymowicz). It is run as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">pyro_sim.py<span class="w"> </span>compressible<span class="w"> </span>quad<span class="w"> </span>inputs.quad</span>
</pre></div></div><img alt="_images/quad.png" class="align-center" src="_images/quad.png" />
</section>
<section id="id9">
<h3>rt<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<p>The Rayleigh-Taylor problem puts a dense fluid over a lighter one and
perturbs the interface with a sinusoidal velocity. Hydrostatic
boundary conditions are used to ensure any initial pressure waves can
escape the domain. It is run as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">pyro_sim.py<span class="w"> </span>compressible<span class="w"> </span>rt<span class="w"> </span>inputs.rt</span>
</pre></div></div><div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; height: auto;">
    <iframe src="https://www.youtube.com/embed/P4zmObEYCOs?rel=0" frameborder="0" allowfullscreen style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"></iframe>
</div><br></section>
<section id="id10">
<h3>bubble<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<p>The bubble problem initializes a hot spot in a stratified domain and
watches it buoyantly rise and roll up. This is run as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">pyro_sim.py<span class="w"> </span>compressible<span class="w"> </span>bubble<span class="w"> </span>inputs.bubble</span>
</pre></div></div><img alt="_images/bubble.png" class="align-center" src="_images/bubble.png" />
<p>The shock at the top of the domain is because we cut off the
stratified atmosphere at some low density and the resulting material
above that rains down on our atmosphere. Also note the acoustic signal
propagating outward from the bubble (visible in the U and e panels).</p>
</section>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<section id="explorations">
<h3>Explorations<a class="headerlink" href="#explorations" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Measure the growth rate of the Rayleigh-Taylor instability for
different wavenumbers.</p></li>
<li><p>There are multiple Riemann solvers in the compressible
algorithm. Run the same problem with the different Riemann solvers
and look at the differences. Toro’s text is a good book to help
understand what is happening.</p></li>
<li><p>Run the problems with and without limiting—do you notice any overshoots?</p></li>
</ul>
</section>
<section id="extensions">
<h3>Extensions<a class="headerlink" href="#extensions" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Limit on the characteristic variables instead of the primitive
variables. What changes do you see? (the notes show how to implement
this change.)</p></li>
<li><p>Add passively advected species to the solver.</p></li>
<li><p>Add an external heating term to the equations.</p></li>
<li><p>Add 2-d axisymmetric coordinates (r-z) to the solver. This is
discussed in the notes. Run the Sedov problem with the explosion on
the symmetric axis—now the solution will behave like the spherical
sedov explosion instead of the cylindrical explosion.</p></li>
<li><p>Swap the piecewise linear reconstruction for piecewise parabolic
(PPM). The notes and the Miller and Colella paper provide a good basis
for this.  Research the Roe Riemann solver and implement it in pyro.</p></li>
</ul>
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="burgers_basics.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Burgers’ Equation</p>
      </div>
    </a>
    <a class="right-next"
       href="diffusion_basics.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Diffusion</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compressible-solver"><code class="docutils literal notranslate"><span class="pre">compressible</span></code> solver</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#supported-problems">supported problems</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#acoustic-pulse"><code class="docutils literal notranslate"><span class="pre">acoustic_pulse</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#advect"><code class="docutils literal notranslate"><span class="pre">advect</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bubble"><code class="docutils literal notranslate"><span class="pre">bubble</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#convection"><code class="docutils literal notranslate"><span class="pre">convection</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#gresho"><code class="docutils literal notranslate"><span class="pre">gresho</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#heating"><code class="docutils literal notranslate"><span class="pre">heating</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hse"><code class="docutils literal notranslate"><span class="pre">hse</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#kh"><code class="docutils literal notranslate"><span class="pre">kh</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#logo"><code class="docutils literal notranslate"><span class="pre">logo</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plume"><code class="docutils literal notranslate"><span class="pre">plume</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#quad"><code class="docutils literal notranslate"><span class="pre">quad</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ramp"><code class="docutils literal notranslate"><span class="pre">ramp</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#rt"><code class="docutils literal notranslate"><span class="pre">rt</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#rt2"><code class="docutils literal notranslate"><span class="pre">rt2</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sedov"><code class="docutils literal notranslate"><span class="pre">sedov</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sod"><code class="docutils literal notranslate"><span class="pre">sod</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#test"><code class="docutils literal notranslate"><span class="pre">test</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compressible-rk-solver"><code class="docutils literal notranslate"><span class="pre">compressible_rk</span></code> solver</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">supported problems</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compressible-fv4-solver"><code class="docutils literal notranslate"><span class="pre">compressible_fv4</span></code> solver</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">supported problems</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compressible-sdc-solver"><code class="docutils literal notranslate"><span class="pre">compressible_sdc</span></code> solver</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">supported problems</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-problems">Example problems</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Sod</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Sedov</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">quad</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">rt</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">bubble</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#explorations">Explorations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extensions">Extensions</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By pyro development team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, pyro development team.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>